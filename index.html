import React, { useState } from 'react';

// --- Helper Components ---

// SVG Icons for the navigation bar
const HomeIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
    <polyline points="9 22 9 12 15 12 15 22"/>
  </svg>
);

const PlusCircleIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <circle cx="12" cy="12" r="10"/>
    <path d="M12 8v8"/>
    <path d="M8 12h8"/>
  </svg>
);

const MessageCircleIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <path d="M7.9 20A9.32 9.32 0 0 1 4 16c-2.3-3.4-1.2-8.5 2.1-11.8a9.42 9.42 0 0 1 13.8 0c3.3 3.3 4.4 8.4 2.1 11.8a9.32 9.32 0 0 1-3.9 4c-.9.3-1.8.6-2.7.7"/>
    <path d="M12 17.5a2.5 2.5 0 0 0 0-5"/>
    <path d="M12 10.5v-2"/>
    <path d="M12 14.5v-2"/>
  </svg>
);

const UserIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/>
    <circle cx="12" cy="7" r="4"/>
  </svg>
);

// A mock navigation bar to be used across screens
const Navbar = ({ currentPage, setPage }) => {
  const navItems = [
    { name: 'Home', icon: <HomeIcon />, page: 'home' },
    { name: 'List', icon: <PlusCircleIcon />, page: 'book-pickup' },
    { name: 'Messages', icon: <MessageCircleIcon />, page: 'messages' },
    { name: 'Profile', icon: <UserIcon />, page: 'profile' },
  ];

  return (
    <nav className="fixed bottom-0 left-0 right-0 bg-white shadow-lg rounded-t-2xl p-4 md:hidden">
      <ul className="flex justify-around items-center">
        {navItems.map((item) => (
          <li key={item.name}>
            <button
              onClick={() => setPage(item.page)}
              className={`flex flex-col items-center text-sm font-medium transition-colors duration-300 ${
                currentPage === item.page ? 'text-green-600' : 'text-gray-500'
              }`}
            >
              {item.icon}
              <span className="mt-1">{item.name}</span>
            </button>
          </li>
        ))}
      </ul>
    </nav>
  );
};

// --- Screen Components ---

const WelcomeScreen = ({ setPage }) => (
  <div className="flex flex-col items-center justify-center min-h-screen bg-gray-50 text-center p-6">
    <div className="max-w-md w-full">
      <div className="w-24 h-24 bg-green-200 rounded-full mx-auto mb-6 flex items-center justify-center">
        {/* Mock App Icon/Logo */}
        <span className="text-5xl" role="img" aria-label="eco-icon">♻️</span>
      </div>
      <h1 className="text-3xl font-bold text-gray-800 mb-2">Turning Waste into Wealth</h1>
      <p className="text-gray-600 mb-8">A multi-sided platform to make segregation, pickup, and tracking easy for Indian households.</p>
      <div className="space-y-4">
        <button
          onClick={() => setPage('home')}
          className="w-full bg-green-600 text-white font-semibold py-3 px-6 rounded-xl shadow-md hover:bg-green-700 transition-colors"
        >
          Sign Up
        </button>
        <button
          onClick={() => setPage('home')}
          className="w-full bg-white text-green-600 font-semibold py-3 px-6 rounded-xl border border-green-600 hover:bg-gray-100 transition-colors"
        >
          Log In
        </button>
      </div>
    </div>
  </div>
);

const HomeDashboard = ({ setPage }) => (
  <div className="min-h-screen bg-gray-100 flex flex-col">
    <div className="p-6 bg-white shadow-md rounded-b-2xl">
      <h2 className="text-2xl font-bold text-gray-800">Hello, Aparna!</h2>
      <p className="text-gray-500">Welcome back. Let's make a difference today!</p>
    </div>

    <main className="flex-grow p-6">
      <div className="bg-green-600 text-white rounded-2xl p-6 shadow-lg mb-6">
        <h3 className="text-xl font-semibold mb-2">Your Impact</h3>
        <p className="text-4xl font-extrabold mb-1">5.2 kg</p>
        <p className="text-sm">of plastic saved this month</p>
      </div>

      <button
        onClick={() => setPage('book-pickup')}
        className="w-full bg-blue-600 text-white font-bold py-4 rounded-2xl shadow-lg hover:bg-blue-700 transition-transform transform hover:scale-105"
      >
        Book a Pickup
      </button>
    </main>

    <div className="h-20"></div> {/* Spacer for the bottom nav bar */}
  </div>
);

const BookPickupScreen = ({ setPage }) => {
  const [wasteType, setWasteType] = useState('');

  return (
    <div className="min-h-screen bg-gray-100 flex flex-col p-6">
      <h2 className="text-2xl font-bold text-gray-800 mb-6">Book a Pickup</h2>
      <div className="bg-white rounded-2xl shadow-md p-6 flex-grow">
        <form>
          <div className="mb-6">
            <label className="block text-gray-700 font-medium mb-2">Select Waste Stream</label>
            <select
              value={wasteType}
              onChange={(e) => setWasteType(e.target.value)}
              className="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all"
            >
              <option value="">Choose a category</option>
              <option value="wet">Wet Waste (Compost/Biogas)</option>
              <option value="dry-recyclables">Dry Recyclables (Paper, Plastic, Metal)</option>
              <option value="e-waste">E-waste & Batteries</option>
              <option value="hazardous">Domestic Hazardous</option>
              <option value="textiles">Textiles & Bulky</option>
            </select>
          </div>

          <div className="mb-6">
            <label className="block text-gray-700 font-medium mb-2">Pickup Date & Time</label>
            <input type="datetime-local" className="w-full p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent transition-all" />
          </div>

          <div className="mb-6">
            <label className="block text-gray-700 font-medium mb-2">Add Photos</label>
            <input type="file" className="w-full" />
          </div>

          <button
            onClick={() => setPage('pickup-confirmation')}
            type="button"
            className="w-full bg-green-600 text-white font-semibold py-4 rounded-2xl shadow-md hover:bg-green-700 transition-colors"
          >
            Confirm Booking
          </button>
        </form>
      </div>
      <div className="h-20"></div> {/* Spacer for the bottom nav bar */}
    </div>
  );
};

const PickupConfirmationScreen = ({ setPage }) => (
  <div className="min-h-screen bg-gray-100 flex flex-col p-6 text-center">
    <div className="flex-grow flex flex-col justify-center items-center">
      <div className="w-20 h-20 bg-green-500 rounded-full flex items-center justify-center mb-6">
        <span className="text-4xl text-white">✅</span>
      </div>
      <h2 className="text-2xl font-bold text-gray-800 mb-2">Booking Confirmed!</h2>
      <p className="text-gray-600 mb-6">Your pickup request has been sent. A partner will be with you shortly.</p>
      <div className="bg-white rounded-2xl shadow-md p-6 mb-6 w-full max-w-sm">
        <h3 className="text-lg font-semibold text-gray-800 mb-2">Tracking your partner</h3>
        <div className="h-40 bg-gray-200 rounded-xl flex items-center justify-center text-gray-500">
          <p>Mock Map goes here...</p>
        </div>
      </div>
      <button
        onClick={() => setPage('home')}
        className="w-full max-w-sm bg-blue-600 text-white font-semibold py-4 rounded-2xl shadow-md hover:bg-blue-700 transition-colors"
      >
        Back to Home
      </button>
    </div>
    <div className="h-20"></div> {/* Spacer for the bottom nav bar */}
  </div>
);

const ProfileAnalyticsScreen = ({ setPage }) => (
  <div className="min-h-screen bg-gray-100 flex flex-col p-6">
    <h2 className="text-2xl font-bold text-gray-800 mb-6">Your Profile & Stats</h2>
    <div className="bg-white rounded-2xl shadow-md p-6 mb-6">
      <div className="flex items-center space-x-4 mb-4">
        <div className="w-16 h-16 bg-gray-300 rounded-full flex items-center justify-center text-gray-600 text-xl font-bold">AP</div>
        <div>
          <h3 className="text-xl font-bold text-gray-800">Aparna Sharma</h3>
          <p className="text-gray-500 text-sm">Member since 2024</p>
        </div>
      </div>
      <div className="flex justify-between items-center bg-gray-100 rounded-xl p-4">
        <div>
          <p className="text-sm text-gray-500">Wallet Balance</p>
          <p className="text-lg font-bold text-green-700">₹ 250</p>
        </div>
        <div>
          <p className="text-sm text-gray-500">Green Points</p>
          <p className="text-lg font-bold text-blue-700">420</p>
        </div>
      </div>
    </div>
    <div className="bg-white rounded-2xl shadow-md p-6 mb-6">
      <h3 className="text-xl font-bold text-gray-800 mb-4">Your Pickup History</h3>
      {/* Mock history list */}
      <ul className="space-y-4">
        <li className="flex justify-between items-center border-b pb-2">
          <span className="text-gray-700">Dry Recyclables (2.1 kg)</span>
          <span className="text-sm text-gray-500">Mar 22, 2024</span>
        </li>
        <li className="flex justify-between items-center border-b pb-2">
          <span className="text-gray-700">Wet Waste (12.5 kg)</span>
          <span className="text-sm text-gray-500">Mar 20, 2024</span>
        </li>
      </ul>
    </div>
    <div className="h-20"></div> {/* Spacer for the bottom nav bar */}
  </div>
);

const MessagesScreen = ({ setPage }) => (
  <div className="min-h-screen bg-gray-100 flex flex-col p-6">
    <h2 className="text-2xl font-bold text-gray-800 mb-6">Messages</h2>
    <div className="bg-white rounded-2xl shadow-md p-6 space-y-4">
      <div className="flex items-center space-x-3 p-3 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors cursor-pointer">
        <div className="w-12 h-12 bg-blue-400 rounded-full flex items-center justify-center text-white font-bold">S</div>
        <div>
          <h3 className="text-lg font-medium text-gray-800">Sita - Partner</h3>
          <p className="text-sm text-gray-500 truncate">Your pickup is scheduled for 10 AM today.</p>
        </div>
      </div>
      <div className="flex items-center space-x-3 p-3 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors cursor-pointer">
        <div className="w-12 h-12 bg-red-400 rounded-full flex items-center justify-center text-white font-bold">R</div>
        <div>
          <h3 className="text-lg font-medium text-gray-800">Ravi - RWA Secretary</h3>
          <p className="text-sm text-gray-500 truncate">Reminder: E-waste drive on Saturday.</p>
        </div>
      </div>
    </div>
    <div className="h-20"></div> {/* Spacer for the bottom nav bar */}
  </div>
);

// --- Main App Component ---

export default function App() {
  const [currentPage, setCurrentPage] = useState('welcome');

  const renderPage = () => {
    switch (currentPage) {
      case 'welcome':
        return <WelcomeScreen setPage={setCurrentPage} />;
      case 'home':
        return <HomeDashboard setPage={setCurrentPage} />;
      case 'book-pickup':
        return <BookPickupScreen setPage={setCurrentPage} />;
      case 'pickup-confirmation':
        return <PickupConfirmationScreen setPage={setCurrentPage} />;
      case 'profile':
        return <ProfileAnalyticsScreen setPage={setCurrentPage} />;
      case 'messages':
        return <MessagesScreen setPage={setCurrentPage} />;
      default:
        return <WelcomeScreen setPage={setCurrentPage} />;
    }
  };

  return (
    <div className="font-sans antialiased text-gray-900 bg-gray-100">
      <style>
        {`
          @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');
          body {
            font-family: 'Inter', sans-serif;
          }
        `}
      </style>
      {renderPage()}
      {currentPage !== 'welcome' && <Navbar currentPage={currentPage} setPage={setCurrentPage} />}
    </div>
  );
}
